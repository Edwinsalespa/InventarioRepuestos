CREATE DATABASE INVENTARIO_REPUESTOS;

USE INVENTARIO_REPUESTOS;

CREATE TABLE USUARIOS(
  ID_USUARIO INT(11) NOT NULL AUTO_INCREMENT,
  NOMBRE VARCHAR(40) NOT NULL,
  APELLIDO VARCHAR(40) NOT NULL,
  CEDULA INT(12) NOT NULL UNIQUE,
  CONTRASENA VARCHAR(10) NOT NULL,
  ROL_ID INT NOT NULL,
  PRIMARY KEY(ID_USUARIO),
  FOREIGN KEY(ROL_ID) REFERENCES ROLES(ID_ROL)  
)ENGINE=MyISAM DEFAULT CHARSET=utf8;

INSERT INTO USUARIOS (ID_USUARIO, NOMBRE, APELLIDO, CEDULA, CONTRASENA, ROL_ID) VALUES
(1, 'ADMINISTRADOR', '', 12345678, 'ADMIN', 1),
(2, 'CRISTHIAN', 'FORERO', 01234567, '1234', 2);

CREATE TABLE ROLES(
  ID_ROL INT(11) NOT NULL AUTO_INCREMENT,
  DESCRIPCION VARCHAR(20) NOT NULL,
  PRIMARY KEY(ID_ROL)
)ENGINE=MyISAM DEFAULT CHARSET=utf8;

ALTER TABLE USUARIOS ADD FOREIGN KEY(ROL_ID) REFERENCES ROLES(ID_ROL);  

INSERT INTO ROLES (ID_ROL, DESCRIPCION) VALUES
(1, 'ADMIN'),
(2, 'BASICO');



CREATE PROCEDURE SP_ListarUsuarios()
SELECT * FROM usuarios

CREATE PROCEDURE SP_LoginUsuario(_cedula INT, _contrasena VARCHAR(10))
SELECT us.id_usuario, us.nombre, us.apellido, us.cedula, us.contrasena, rol.descripcion FROM
usuarios us JOIN roles rol ON us.ROL_ID = rol.ID_ROL
WHERE CEDULA = _CEDULA AND CONTRASENA = _contrasena

